---
title: whisper 구현기 (웹브라우저에서 작동하는)
published: 0001-01-01
description: ""
tags: []
category: Default
draft: false
---

transformers.js에 이미 웹브라우저용 whisper가 구현되어 있기는 하다.

이 transformers.js를 참조하여 위스퍼를 다시 구현했다 

최적화를 논하려면 먼저 위스퍼가 어떻게 작동하는지 그 흐름을 알아야 한다 

# WHISPER가 어떻게 작동하는가 (실행 흐름)

# 최적화 전략 

시도해본 것이 몇개 있기는 하다. 

첫번째로, 일부 js로직을 wasm으로 변환했다. 
wasm은 SIMD128 명령어를 지원하므로 

두번째로, 오닉스 세션을 병렬로 실행했다. 이렇게 하면 GPU 사용량을 90%이상으로 유지할 수 있다
이것은 LLM에서는 불가능하지만 위스퍼는 그 특유의 알고리즘덕에 병렬 처리가 가능한 것이다
위스퍼는 30초 

세번째로, onnx-runtime-web의 matmul 커널을 튜닝한것이다

# 벤치마크

INTEL 12세대 GPU 기준
동영상 : 메트릭스의 스테이크 씬 약 (1분 30초)
최적화전 132초에서 최적화후 100초로 약 ㅇㅇ% 속도가 향상되었다

# FURTHER STUDY 

마법소녀 리나 동영상은 초당 토큰 생성량이 약 14개인데 매트릭스 영상은 약 4~5개 사이를 왔다갔다한다.
동영상별로 속도에 차이가 생기는 이유는 무엇인가 ?